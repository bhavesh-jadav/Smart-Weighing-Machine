@model UserDashboardModel
@{
    ViewBag.Title = "Dashboard";
    ViewBag.PageHeader = "Dashboard";
    ViewBag.PageHeaderSmall = "Overview of your data";
}
@if (!Model.IsNewUser)
{
    <div ng-app="app-dashboard">
        <section class="content">
            <div class="row">
                <div class="col-lg-3 col-xs-6">
                    <div class="small-box bg-aqua">
                        <div class="inner">
                            @if (Model.TotalWeight > 1000)
                            {
                                <h3>@((Model.TotalWeight / 1000.0).ToString("n2")) Kg</h3>
                            }
                            else
                            {
                                <h3>@Model.TotalWeight Grams</h3>
                            }

                            <p>Weight</p>
                        </div>
                        <div class="icon" style="margin-top:-10px;">
                            <i class="fa  fa-balance-scale" style="font-size:0.73em;"></i>
                        </div>
                        <a asp-action="ShowData" asp-controller="User" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-xs-6">
                    <div class="small-box bg-green">
                        <div class="inner">
                            <h3>@Model.TotalProducts</h3>

                            <p>Products</p>
                        </div>
                        <div class="icon" style="top:-20px;">
                            <i class="fa  fa-cube" style="font-size:0.8em;"></i>
                        </div>
                        <a href="#products" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-xs-6">
                    <div class="small-box bg-yellow">
                        <div class="inner">
                            <h3>@Model.TotalLocation</h3>

                            <p>Locations</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-android-globe"></i>
                        </div>
                        <a href="#locationsInfo" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-xs-6">
                    <div class="small-box bg-red">
                        <div class="inner">
                            <h3>@Model.LastUpdatedProduct</h3>

                            <p>Last Updated</p>
                        </div>
                        <div class="icon" style="top:-20px;">
                            <i class="fa  fa-refresh" style="font-size:0.8em;"></i>
                        </div>
                        <a asp-action="ShowData" asp-controller="User" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
            </div>
            @if (Model.HaveSomeData)
            {
                <div ng-controller="chartsController">
                    <div class="row">
                        <div class="{{chartClass}}">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">
                                        Location Wise Product Information
                                    </h3>
                                    <div class="pull-right">
                                        <span class="input-group-addon" style="width:0;">Select location</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="selectedLocation">
                                                <option ng-repeat="item in locations" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-btn" style="width:0;">
                                            <button type="button" class="btn btn-primary btn-flat" ng-click="displayChart1()">Go!</button>
                                        </span>
                                    </div>
                                    <div style="color:red;">{{chart1Error}}</div>
                                </div>
                                <div id="chart1div" class="box-body">
                                    <div class="chart">
                                        <canvas id="chart1" style="height: 250px;" height="250" width="787"></canvas>
                                    </div>
                                </div>
                                <div class="overlay" ng-show="isBusyChart1">
                                    <i class="fa fa-refresh fa-spin"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6" ng-show="showMonthlyCharts">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">
                                        Location Wise Total Weight
                                    </h3>
                                    <div class="pull-right">
                                        <span class="input-group-addon" style="width:0;">Show data from</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart4StartDate">
                                                <option ng-repeat="item in monthLabels" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-addon" style="width:0;">to</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart4EndDate">
                                                <option ng-repeat="item in monthLabels" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-btn" style="width:0;">
                                            <button type="button" class="btn btn-primary btn-flat" ng-click="displayChart4()">Go!</button>
                                        </span>
                                    </div>
                                    <div style="color:red;">{{chart4Error}}</div>
                                </div>
                                <div class="box-body">
                                    <div id="chart4div" class="chart">
                                        <canvas id="chart4" style="height: 250px;" height="250" width="787"></canvas>
                                    </div>
                                </div>
                                <div class="overlay" ng-show="isBusyChart4">
                                    <i class="fa fa-refresh fa-spin"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" ng-show="showMonthlyCharts">
                        <div class="col-md-12">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">
                                        All Products Monthly Data
                                    </h3>
                                    <div class="pull-right">
                                        <span class="input-group-addon" style="width:0;">Show data from</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart2StartDate">
                                                <option ng-repeat="item in monthLabels" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-addon" style="width:0;">to</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart2EndDate">
                                                <option ng-repeat="item in monthLabels" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-btn" style="width:0;">
                                            <button type="button" class="btn btn-primary btn-flat" ng-click="displayChart2()">Go!</button>
                                        </span>
                                    </div>
                                    <div style="color:red;">{{chart2Error}}</div>
                                </div>
                                <div class="box-body">
                                    <div id="chart2div" class="chart">
                                        <canvas id="chart2" style="height:300px;" height="300"></canvas>
                                    </div>
                                </div>
                                <div class="overlay" ng-show="isBusyChart2">
                                    <i class="fa fa-refresh fa-spin"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" ng-show="showMonthlyCharts">
                        <div class="col-md-12">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">
                                        Single Product Monthly Data
                                    </h3>
                                    <div class="pull-right">
                                        <span class="input-group-addon" style="width:0;">Select Product</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart3ProductName">
                                                <option ng-repeat="item in products" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-addon" style="width:0;">Show data from</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart3StartDate">
                                                <option ng-repeat="item in monthLabels" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-addon" style="width:0;">to</span>
                                        <span class="input-group-btn" style="width:0;">
                                            <select class="form-control" ng-model="chart3EndDate">
                                                <option ng-repeat="item in monthLabels" value="{{item}}">
                                                    {{item}}
                                                </option>
                                            </select>
                                        </span>
                                        <span class="input-group-btn" style="width:0;">
                                            <button type="button" class="btn btn-primary btn-flat" ng-click="displayChart3()">Go!</button>
                                        </span>
                                    </div>
                                    <div style="color:red;">{{chart3Error}}</div>
                                </div>
                                <div class="box-body">
                                    <div id="chart3div" class="chart">
                                        <canvas id="chart3" style="height:250px;" height="250"></canvas>
                                    </div>
                                </div>
                                <div class="overlay" ng-show="isBusyChart3">
                                    <i class="fa fa-refresh fa-spin"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" id="locationsInfo">
                        <div id="locations" class="{{chartClass}}">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">Farm Locations</h3>
                                </div>
                                <div class="box-body">
                                    @if (Model.UserLocations != null)
                                    {
                                        foreach (var location in Model.UserLocations)
                                        {
                                            <div style="margin-bottom:10px;">
                                                <P style="margin:0"><b>Farm Name:</b> @location.Name</P>
                                                <P style="margin:0"><b>Address:</b> @location.Address</P>
                                                <div style="overflow-x:auto">
                                                    <span><b>Pin No:</b> @location.PinNo, </span>
                                                    <span><b>State:</b> @location.State, </span>
                                                    <span><b>Country:</b> @location.Country, </span>
                                                </div>
                                            </div>
                                        }
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6" ng-show="showMonthlyCharts">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">
                                        Monthly Total Weight
                                    </h3>
                                    <div style="color:red;">{{chart1Error}}</div>
                                </div>
                                <div class="box-body">
                                    <div id="chart5div" class="chart">
                                        <canvas id="chart5" style="height: 250px;" height="250" width="787"></canvas>
                                    </div>
                                </div>
                                <div class="overlay" ng-show="isBusyChart5">
                                    <i class="fa fa-refresh fa-spin"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" id="products">
                        <div class="col-md-12">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">
                                        Products Into Account
                                    </h3>
                                </div>
                                <div class="box-body">
                                    @Model.ProductsIntoAccount
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <div class="row">
                    <div class="col-md-12">
                        <div class="callout callout-info">
                            <h4>Hello there,</h4>
                            <p>You have added locations and some products into your account but your account doesn't have any data to display.</p>
                            <p>User your weighing machine to add some data to your account</p>
                            <p>For any query <a href="/contact">Contact Us</a></p>
                        </div>
                    </div>
                </div>
                <div class="row" id="locations">
                    <div class="col-md-12">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">Farm Locations</h3>
                            </div>
                            <div class="box-body">
                                @if (Model.UserLocations != null)
                                {
                                    foreach (var location in Model.UserLocations)
                                    {
                                        <div style="margin-bottom:10px;">
                                            <P style="margin:0"><b>Farm Name:</b> @location.Name</P>
                                            <P style="margin:0"><b>Address:</b> @location.Address</P>
                                            <div style="overflow-x:auto">
                                                <span><b>Pin No:</b> @location.PinNo, </span>
                                                <span><b>State:</b> @location.State, </span>
                                                <span><b>Country:</b> @location.Country, </span>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" id="products">
                    <div class="col-md-12">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">
                                    Products Into Account
                                </h3>
                            </div>
                            <div class="box-body">
                                @Model.ProductsIntoAccount
                            </div>
                        </div>
                    </div>
                </div>
            }

        </section>
    </div>
    @section scripts{
        <script src="~/lib/angular/angular.min.js"></script>
        <script src="~/plugins/Chart.min.js"></script>
        @*<script src="~/dist/js/dashboardScript.js"></script>*@
        <script src="~/dist/js/_app/dashboardScript.js"></script>
        <script>var username = "@Model.UserName.ToString()"; user_dashboard(username);</script>
    }
}
else
{
    <section class="content">
        <div class="row">
            <div class="col-md-12">
                <div class="callout callout-info">
                    <h4>Hello there,</h4>
                    <p>Looks like you are a new user.</p>
                    <p>Go to <a href="/AddNewLocation">Add New Location</a> to add a new locations</p>
                    <p>Go to <a href="/AddNewProduct">Add New Product</a> to add a new product</p>
                    <p>All the other functions will be available once you complete two steps mentioned above.</p>
                </div>
            </div>
        </div>
    </section>
}