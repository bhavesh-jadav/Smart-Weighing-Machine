function user_dashboard(n){"use strict";function s(s,c){s.isBusyChart1=!0;c.get("/api/"+n+"/product_info").then(function(n){s.data=n.data;for(var t=0;t<s.data.length;t++)r.push(s.data[t]);s.isBusyChart1=!1;h()},function(){s.chart1Error="Unable to display chart"});s.isBusyChart2=!0;c.get("/api/"+n+"/product_info_month_wise").then(function(n){var h,c,r,a;for(s.data=n.data,r=0;r<s.data.length;r++)t.push(s.data[r]);for(h=t.length>=6?t.length-6:0,c=t.length,r=0;r<t.length;r++)a=new Date(t[r].date),i.push(o[a.getMonth()]+" "+a.getFullYear());l(t);s.products=u;s.chart3ProductName=u[0];s.chart3StartDate=i[h];s.chart3EndDate=i[c-1];s.chart2StartDate=i[h];s.chart2EndDate=i[c-1];s.chart2Dates=i;s.isBusyChart2=!1;s.chart2Error=e(s.chart2StartDate,s.chart2EndDate);s.chart3Error=f(s.chart3ProductName,s.chart3StartDate,s.chart3EndDate)},function(){s.chart2Error="Unable to display chart"});s.displayChart2=function(){s.chart2Error=e(s.chart2StartDate,s.chart2EndDate)};s.displayChart3=function(){s.chart3Error=f(s.chart3ProductName,s.chart3StartDate,s.chart3EndDate)}}function f(n,r,u){var s,h,c,e,o,f,l,y;if(r==u)return"Start month and end month must not have same value";for(f=0;f<i.length;f++)i[f]===r?h=f:i[f]===u&&(s=f);if(h>s)return"Start month must come before end month";for(c=[],f=h;f<=s;f++)c.push(i[f]);for(e=[],f=0;f<t.length;f++){for(o=0;o<t[f].productInformation.length;o++)if(t[f].productInformation[o].productName==n){e.push(t[f].productInformation[o].totalWeight);break}o==t[f].productInformation.length&&e.push(0)}e=e.slice(h,s+1);var a=[{label:n,data:e,backgroundColor:"#f7ab40",borderWidth:5,borderColor:"#d68413",lineTension:0}],v={labels:c,datasets:a};return $("#chart3div").empty(),$("#chart3div").append('<canvas id="chart3" height=400><\/canvas>'),l=document.getElementById("chart3").getContext("2d"),y=new Chart(l,{type:"line",data:v,options:{scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Products"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"}}]},legend:{display:!1,labels:{display:!1}}}}),""}function e(n,r){var f,e,u,s,h,l,b;if(n==r)return"Start month and end month must not have same value";for(u=0;u<i.length;u++)i[u]===n?e=u:i[u]===r&&(f=u);if(e>f)return"Start month must come before end month";const a=n=>[...new Set(n)],v=n=>[].concat.apply([],n);var y=t.map(function(n){return n.date}),p=a(v(t.map(function(n){return n.productInformation})).map(function(n){return n.productName})),w=p.map(function(n){return{label:n,data:y.map(function(i){var r=t.find(function(n){return n.date===i}).productInformation.find(function(t){return t.productName===n});return r?r.totalWeight:0}).slice(e,f+1),backgroundColor:c()}}),o=[];for(u=e;u<=f;u++)o.push(i[u]);return s={labels:o,datasets:w},h={responsive:!0,legend:{display:!0,position:"top"},scales:{xAxes:[{display:!0,stacked:!0,scaleLabel:{display:!0,labelString:"Months"}}],yAxes:[{display:!0,stacked:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"}}]}},$("#chart2div").empty(),$("#chart2div").append('<canvas id="chart2" height=400><\/canvas>'),l=document.getElementById("chart2").getContext("2d"),b=new Chart(l,{type:"bar",data:s,options:h}),""}function h(){for(var t=[],i=[],n=0;n<r.length;n++)t.push(r[n].productName),i.push(r[n].totalWeight);var e=$("#chart1").get(0).getContext("2d"),u={labels:t,datasets:[{label:"Weight in grams",data:i,backgroundColor:"#3c8dbc"}]},f=document.getElementById("chart1").getContext("2d"),o=new Chart(f,{type:"bar",data:u,options:{scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Products"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"}}]},legend:{display:!1}}})}function c(){for(var n="#",t=0;t<6;t++)n+="0123456789ABCDEF"[Math.floor(Math.random()*16)];return n}function l(n){for(var r,i=0,t=0;t<n.length;t++)n[t].productInformation.length>i&&(i=n[t].productInformation.length,r=t);for(t=0;t<i;t++)u.push(n[r].productInformation[t].productName)}var r=[],t=[],i=[],u=[],o=["January","February","March","April","May","June","July","August","September","October","November","December"];angular.module("app-dashboard",[]);angular.module("app-dashboard").controller("chartsController",["$scope","$http",s])}