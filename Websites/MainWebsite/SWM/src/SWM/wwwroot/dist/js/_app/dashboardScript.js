function user_dashboard(t){"use strict";function a(a,i){a.isBusyChart1=!0,a.isBusyChart5=!0,i.get("/api/"+t+"/location_info").then(function(t){for(var e=t.data,n=0;n<e.length;n++)u.push(e[n].name),g.push(e[n].totalWeight);u.length>1&&u.push("All"),a.locations=u,a.selectedLocation=u[u.length-1],a.displayChart1(),a.isBusyChart5=!1,r()},function(t){a.chart1Error="Unable to display chart"}),a.isBusyChart2=!0,a.showMonthlyCharts=!0,a.chartClass="col-md-6",i.get("/api/"+t+"/product_info_month_wise").then(function(t){var r=t.data;if(r.length>1){for(var l=0;l<r.length;l++)c.push(r[l]);if(c.length>=p)var i=c.length-p;else var i=0;for(var u=c.length,l=0;l<c.length;l++){var g=new Date(c[l].date);h.push(f[g.getMonth()]+" "+g.getFullYear())}s(c),a.products=d,a.chart3ProductName=d[0],a.chart3StartDate=h[i],a.chart3EndDate=h[u-1],a.chart2StartDate=h[i],a.chart2EndDate=h[u-1],a.chart2Dates=h,a.chart4StartDate=h[i],a.chart4EndDate=h[u-1],a.isBusyChart2=!1,a.chart2Error=o(a.chart2StartDate,a.chart2EndDate),a.chart3Error=n(a.chart3ProductName,a.chart3StartDate,a.chart3EndDate),a.chart4Error=e(a.chart4StartDate,a.chart4EndDate)}else a.showMonthlyCharts=!1,a.chartClass="col-md-12"},function(t){a.chart2Error=a.chart3Error=a.chart4Error="Unable to display chart",a.isBusyChart2=!1}),a.displayChart1=function(){var r=[];if(a.isBusyChart1=!0,a.selectedLocation===u[u.length-1])i.get("/api/"+t+"/product_info").then(function(t){for(var e=t.data,n=0;n<e.length;n++)r.push(e[n]);a.isBusyChart1=!1,l(r)},function(t){a.chart1Error="Unable to display chart"});else for(var e=0;e<u.length;e++)u[e]==a.selectedLocation&&i.get("/api/"+t+"/"+u[e]+"/product_info").then(function(t){for(var e=t.data,n=0;n<e.length;n++)r.push(e[n]);a.isBusyChart1=!1,l(r)},function(t){a.chart1Error="Unable to display chart"})},a.displayChart2=function(){a.chart2Error=o(a.chart2StartDate,a.chart2EndDate)},a.displayChart3=function(){a.chart3Error=n(a.chart3ProductName,a.chart3StartDate,a.chart3EndDate)},a.displayChart4=function(){a.chart4Error=e(a.chart4StartDate,a.chart4EndDate)}}function r(){for(var t=[],a=0;a<u.length-1;a++)t.push(u[a]);var r={labels:t,datasets:[{data:g,backgroundColor:"#ff7272"}]},e={scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Weight"},ticks:{beginAtZero:!0}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Locations"}}]},legend:{display:!1},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,a){var r=t.yLabel;return r<=1e3?t.xLabel+" gm":t.xLabel/1e3+" kg"}},displayColors:!1}},n=$("#locations").height()-Math.floor(.3*$("#locations").height());$("#chart5div").empty(),$("#chart5div").append('<canvas id="chart5" style="height:'+n+'" height="'+n+'" width="787"></canvas>');var o=document.getElementById("chart5").getContext("2d");new Chart(o,{type:"horizontalBar",data:r,options:e})}function e(t,a){function r(t){if(Array.isArray(t)){for(var a=0,r=Array(t.length);a<t.length;a++)r[a]=t[a];return r}return Array.from(t)}if(t==a)return"Start month and end month must not have same value";for(var e,n,o=0;o<h.length;o++)h[o]===t?n=o:h[o]===a&&(e=o);if(n>e)return"Start month must come before end month";for(var l=function(t){return[].concat(r(new Set(t)))},i=function(t){return[].concat.apply([],t)},s=c.map(function(t){return t.date}),d=l(i(c.map(function(t){return t.productInformation})).map(function(t){return t.productName})),u=d.map(function(t){return{data:s.map(function(a){var r=c.find(function(t){return t.date===a}).productInformation.find(function(a){return a.productName===t});return r?r.totalWeight:0}).slice(n,e+1)}}),p=[],o=n;o<=e;o++)p.push(h[o]);for(var g=[],o=0;o<u[0].data.length;o++){for(var f=0,m=0;m<u.length;m++)f+=u[m].data[o];g.push(f)}var y={labels:p,datasets:[{label:"Weight in grams",data:g,backgroundColor:"#ff7272"}]},b={scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Months"},ticks:{beginAtZero:!0}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"}}]},legend:{display:!1},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,a){var r=t.yLabel;return r<=1e3?t.xLabel+" gm":t.xLabel/1e3+" kg"}},displayColors:!1}};$("#chart4div").empty(),$("#chart4div").append('<canvas id="chart4" style="height: 250px;" height="250" width="787"></canvas>');var v=document.getElementById("chart4").getContext("2d");new Chart(v,{type:"horizontalBar",data:y,options:b});return""}function n(t,a,r){if(a==r)return"Start month and end month must not have same value";for(var e,n,o=0;o<h.length;o++)h[o]===a?n=o:h[o]===r&&(e=o);if(n>e)return"Start month must come before end month";for(var l=[],o=n;o<=e;o++)l.push(h[o]);for(var i,s=[],o=0;o<c.length;o++){for(i=0;i<c[o].productInformation.length;i++)if(c[o].productInformation[i].productName==t){s.push(c[o].productInformation[i].totalWeight);break}i==c[o].productInformation.length&&s.push(0)}s=s.slice(n,e+1);var d=[{label:t,data:s,backgroundColor:"#f7ab40",borderWidth:5,borderColor:"#d68413",cubicInterpolationMode:"monotone"}],u={labels:l,datasets:d},p={scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Products"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"},ticks:{beginAtZero:!0}}]},legend:{display:!1,labels:{display:!1}},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,a){var r=t.yLabel;return r<=1e3?t.yLabel+" gm":t.yLabel/1e3+" kg"}},displayColors:!1}};$("#chart3div").empty(),$("#chart3div").append('<canvas id="chart3" style="height:250px;" height="250"></canvas>');var g=document.getElementById("chart3").getContext("2d");new Chart(g,{type:"line",data:u,options:p});return""}function o(t,a){function r(t){if(Array.isArray(t)){for(var a=0,r=Array(t.length);a<t.length;a++)r[a]=t[a];return r}return Array.from(t)}if(t==a)return"Start month and end month must not have same value";for(var e,n,o=0;o<h.length;o++)h[o]===t?n=o:h[o]===a&&(e=o);if(n>e)return"Start month must come before end month";for(var l=function(t){return[].concat(r(new Set(t)))},s=function(t){return[].concat.apply([],t)},d=c.map(function(t){return t.date}),u=l(s(c.map(function(t){return t.productInformation})).map(function(t){return t.productName})),p=u.map(function(t){return{label:t,data:d.map(function(a){var r=c.find(function(t){return t.date===a}).productInformation.find(function(a){return a.productName===t});return r?r.totalWeight:0}).slice(n,e+1),backgroundColor:i()}}),g=[],o=n;o<=e;o++)g.push(h[o]);var f={labels:g,datasets:p},m={responsive:!0,legend:{display:!0,position:"top"},scales:{xAxes:[{display:!0,stacked:!0,scaleLabel:{display:!0,labelString:"Months"}}],yAxes:[{display:!0,stacked:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"}}]},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,a){return a.datasets[t.datasetIndex].label+": "+t.yLabel+" gm"}}}};$("#chart2div").empty(),$("#chart2div").append('<canvas id="chart2" style="height:300px;" height="300"></canvas>');var y=document.getElementById("chart2").getContext("2d");new Chart(y,{type:"bar",data:f,options:m});return""}function l(t){for(var a=[],r=[],e=0;e<t.length;e++)a.push(t[e].productName),r.push(t[e].totalWeight);var n={labels:a,datasets:[{label:"Weight in grams",data:r,backgroundColor:"#3c8dbc"}]},o={scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Products"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Weight In Grams"},ticks:{beginAtZero:!0}}]},legend:{display:!1},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,a){var r=t.yLabel;return r<=1e3?t.yLabel+" gm":t.yLabel/1e3+" kg"}},displayColors:!1}};$("#chart1div").empty(),$("#chart1div").append('<canvas id="chart1" style="height: 250px;" height="250" width="787"></canvas>');var l=document.getElementById("chart1").getContext("2d");new Chart(l,{type:"bar",data:n,options:o})}function i(){for(var t="0123456789ABCDEF",a="#",r=0;r<6;r++)a+=t[Math.floor(16*Math.random())];return a}function s(t){for(var a,r=0,e=0;e<t.length;e++)t[e].productInformation.length>r&&(r=t[e].productInformation.length,a=e);for(var e=0;e<r;e++)d.push(t[a].productInformation[e].productName)}var c=[],h=[],d=[],u=[],p=10,g=[],f=["January","February","March","April","May","June","July","August","September","October","November","December"];angular.module("app-dashboard",[]),angular.module("app-dashboard").controller("chartsController",["$scope","$http",a])}